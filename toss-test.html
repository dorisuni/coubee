<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>초간단 PortOne V2 토스페이 테스트</title>
    <!-- PortOne V2 Browser SDK -->
    <script src="https://cdn.portone.io/v2/browser-sdk.js"></script>
    <style>
        body { font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; background-color: #f0f2f5; }
        .container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; }
        #tossPayButton { background-color: #007bff; color: white; padding: 15px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 18px; font-weight: bold; }
        #log { margin-top: 20px; padding: 15px; background: #282c34; color: #61dafb; text-align: left; white-space: pre-wrap; font-family: monospace; border-radius: 5px; max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🚀 토스페이 결제창 호출 테스트</h1>
        <p>이 페이지는 백엔드 없이 오직 프론트엔드만으로<br>PortOne 토스페이 결제를 테스트합니다.</p>
        <button id="tossPayButton">토스페이 결제 테스트 (1,000원)</button>
        <pre id="log">로그가 여기에 표시됩니다...</pre>
    </div>

    <script>
        const tossPayButton = document.getElementById('tossPayButton');
        const logElement = document.getElementById('log');

        function log(message) {
            console.log(message);
            logElement.textContent += `[${new Date().toLocaleTimeString()}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        async function doTossPayment() {
            log('PortOne SDK 로드 확인 중...');
            if (typeof window.PortOne === 'undefined') {
                log('오류: PortOne SDK가 로드되지 않았습니다.');
                return;
            }
            log('✅ PortOne SDK 로드 완료.');

            // ===================================================================
            // ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼ 이 값을 본인의 정보로 확인해주세요 ▼▼▼▼▼▼▼▼▼▼▼▼▼▼▼
            // ===================================================================
            const myStoreId = "store-a9463375-7b07-40fc-8c4f-e0bd4fb0c2b7";
            const myTossPayChannelKey = "channel-key-375e06c6-e99f-4563-a94a-04a3752d0243";
            // ===================================================================
            // ▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲▲
            // ===================================================================

            const paymentData = {
                // 스토어 ID와 채널 키
                storeId: myStoreId,
                channelKey: myTossPayChannelKey,
                
                // --- 주문 정보 (필수) ---
                paymentId: `order_test_${Date.now()}`, // 매번 다른 ID 생성
                orderName: "토스페이 테스트 결제",
                totalAmount: 1000,
                currency: "KRW",
                
                // --- 결제 수단 정보 (필수) ---
                payMethod: "EASY_PAY",

                // --- 구매자 정보 (권장) ---
                customer: {
                    fullName: "포트원",
                    phoneNumber: "010-0000-1234",
                    email: "test@portone.io"
                },
            };
            
            log('결제 요청을 보냅니다...');
            log('요청 데이터: ' + JSON.stringify(paymentData, null, 2));
            
            try {
                const response = await PortOne.requestPayment(paymentData);
                
                if (response.code != null) {
                    // 결제 실패 또는 사용자가 창을 닫은 경우
                    log(`❌ 결제 실패 또는 중단`);
                    log(`   - 코드: ${response.code}`);
                    log(`   - 메시지: ${response.message}`);
                } else {
                    // 결제 성공
                    log(`🎉 결제 성공!`);
                    log(`   - paymentId: ${response.paymentId}`);
                    log(`   - txId: ${response.txId}`);
                    alert('결제 성공!');
                }
            } catch (error) {
                log(`💥 SDK 호출 중 예외 발생: ${error.message}`);
            }
        }

        tossPayButton.addEventListener('click', doTossPayment);
        
        window.addEventListener('load', () => {
             log('페이지 로드 완료. 버튼을 클릭하여 테스트를 시작하세요.');
        });
    </script>
</body>
</html>